{% extends 'base.html' %}
{% load static %}
{% block title %}My Profile - SceaniCollections{% endblock %}

{% block extra_css %}
<style>
.profile-header {background: #1a237e;}
.profile-avatar {border: 3px solid #D4AF37; box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);}
.profile-card {transition: transform 0.3s ease, box-shadow 0.3s ease; border: 1px solid #e5e7eb;}
.profile-card:hover {transform: translateY(-2px); box-shadow: 0 12px 40px rgba(0,0,0,0.08);}
.stat-card {background: #1a237e; border: 1px solid rgba(212, 175, 55, 0.2);}
.input-focus:focus {border-color: #1a237e; box-shadow: 0 0 0 3px rgba(0, 0, 0, 0.05);}
</style>
{% endblock %}

{% block content %}
<div class="min-h-screen bg-gray-50">
<!-- Profile Header Banner -->
<div class="profile-header text-white py-16 relative overflow-hidden">
<div class="absolute inset-0 opacity-5"><svg class="w-full h-full" viewBox="0 0 100 100" preserveAspectRatio="none"><defs><pattern id="grain" width="100" height="100" patternUnits="userSpaceOnUse"><circle cx="25" cy="25" r="1" fill="white"/><circle cx="75" cy="75" r="1" fill="white"/><circle cx="50" cy="10" r="0.5" fill="white"/></pattern></defs><rect width="100" height="100" fill="url(#grain)"/></svg></div>
<div class="absolute top-0 right-0 w-1/2 h-full bg-gradient-to-l from-amber-500/5 to-transparent"></div>
<div class="container mx-auto px-4 relative z-10">
<div class="flex flex-col md:flex-row items-center md:items-end gap-4 md:gap-0 md:space-x-8">
<!-- Avatar -->
<div class="relative">
<div class="profile-avatar w-24 h-24 sm:w-32 sm:h-32 md:w-40 md:h-40 rounded-full bg-gradient-to-br from-gray-800 to-gray-900 flex items-center justify-center overflow-hidden">{% if user.profile_image %}<img src="{{ user.profile_image.url }}" alt="{{ user.get_full_name }}" class="w-full h-full object-cover">{% else %}<span class="text-3xl sm:text-4xl md:text-5xl font-bold text-amber-500">{{ user.first_name|first|upper }}{{ user.last_name|first|upper }}</span>{% endif %}</div>
<div class="absolute bottom-1 right-1 sm:bottom-2 sm:right-2 w-5 h-5 sm:w-6 sm:h-6 bg-green-500 rounded-full border-2 border-scent-blue" title="Online"></div>
</div>
<!-- User Info -->
<div class="text-center md:text-left flex-1">
<h1 class="text-2xl sm:text-3xl md:text-4xl font-bold mb-1 sm:mb-2">{{ user.get_full_name|default:user.username }}</h1>
<p class="text-amber-500 text-base sm:text-lg mb-2 sm:mb-3">@{{ user.username }}</p>
<div class="flex flex-wrap justify-center md:justify-start gap-2 sm:gap-4 text-xs sm:text-sm">
<span class="flex items-center text-gray-400"><i class="fas fa-envelope mr-1 sm:mr-2 text-amber-500"></i> <span class="truncate max-w-[150px] sm:max-w-none">{{ user.email|default:"No email" }}</span></span>
{% if user.phone %}<span class="flex items-center text-gray-400"><i class="fas fa-phone mr-1 sm:mr-2 text-amber-500"></i> {{ user.phone }}</span>{% endif %}
<span class="flex items-center text-gray-400"><i class="fas fa-calendar-alt mr-1 sm:mr-2 text-amber-500"></i> {{ user.date_joined|date:"M Y" }}</span>
</div>
</div>
<!-- Quick Stats -->
<div class="hidden lg:flex space-x-6">
<div class="text-center"><div class="text-3xl font-bold text-amber-500">{{ user.orders.count|default:0 }}</div><div class="text-sm text-gray-500">Orders</div></div>
<div class="text-center"><div class="text-3xl font-bold text-amber-500">{{ user.wishlist.products.count|default:0 }}</div><div class="text-sm text-gray-500">Wishlist</div></div>
<div class="text-center"><div class="text-3xl font-bold text-amber-500">{{ user.addresses.count|default:0 }}</div><div class="text-sm text-gray-500">Addresses</div></div>
</div>
</div>
</div>
</div>

<div class="container mx-auto px-4 py-8">
<!-- Messages -->
{% if messages %}
<div class="mb-6">{% for message in messages %}<div class="p-4 rounded-lg mb-2 {% if message.tags == 'success' %}bg-green-50 text-green-800 border border-green-200{% elif message.tags == 'error' %}bg-red-50 text-red-800 border border-red-200{% else %}bg-amber-50 text-amber-800 border border-amber-200{% endif %}"><i class="fas {% if message.tags == 'success' %}fa-check-circle{% elif message.tags == 'error' %}fa-exclamation-circle{% else %}fa-info-circle{% endif %} mr-2"></i>{{ message }}</div>{% endfor %}</div>
{% endif %}

<!-- Stats Cards (Mobile) -->
<div class="grid grid-cols-3 gap-2 sm:gap-4 mb-6 sm:mb-8 lg:hidden">
<div class="stat-card rounded-xl p-3 sm:p-4 text-center"><i class="fas fa-shopping-bag text-amber-500 text-lg sm:text-2xl mb-1 sm:mb-2"></i><div class="text-xl sm:text-2xl font-bold text-white">{{ user.orders.count|default:0 }}</div><div class="text-[10px] sm:text-xs text-gray-500">Orders</div></div>
<div class="stat-card rounded-xl p-3 sm:p-4 text-center"><i class="fas fa-heart text-amber-500 text-lg sm:text-2xl mb-1 sm:mb-2"></i><div class="text-xl sm:text-2xl font-bold text-white">{{ user.wishlist.products.count|default:0 }}</div><div class="text-[10px] sm:text-xs text-gray-500">Wishlist</div></div>
<div class="stat-card rounded-xl p-3 sm:p-4 text-center"><i class="fas fa-map-marker-alt text-amber-500 text-lg sm:text-2xl mb-1 sm:mb-2"></i><div class="text-xl sm:text-2xl font-bold text-white">{{ user.addresses.count|default:0 }}</div><div class="text-[10px] sm:text-xs text-gray-500">Addresses</div></div>
</div>

<div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
<!-- Left Column - Account Info -->
<div class="lg:col-span-1 space-y-6">
<!-- Account Status Card -->
<div class="profile-card bg-white rounded-xl shadow-sm p-6">
<h3 class="text-lg font-bold text-gray-900 mb-4 flex items-center"><i class="fas fa-shield-alt text-amber-500 mr-3"></i> Account Status</h3>
<div class="space-y-4">
<div class="flex items-center justify-between p-3 bg-gray-50 rounded-lg"><span class="text-gray-600 text-sm"><i class="fas fa-user-tag mr-2"></i> Account Type</span><span class="px-3 py-1 rounded-full text-xs font-medium {% if user.user_type == 'admin' %}bg-gray-900 text-white{% elif user.user_type == 'staff' %}bg-gray-700 text-white{% else %}bg-amber-100 text-amber-800{% endif %}">{{ user.get_user_type_display }}</span></div>
<div class="flex items-center justify-between p-3 bg-gray-50 rounded-lg"><span class="text-gray-600 text-sm"><i class="fas fa-envelope-circle-check mr-2"></i> Email Status</span><span class="px-3 py-1 rounded-full text-xs font-medium {% if user.email_verified %}bg-green-50 text-green-700{% else %}bg-yellow-50 text-yellow-700{% endif %}">{% if user.email_verified %}Verified{% else %}Not Verified{% endif %}</span></div>
<div class="flex items-center justify-between p-3 bg-gray-50 rounded-lg"><span class="text-gray-600 text-sm"><i class="fas fa-bell mr-2"></i> Newsletter</span><span class="px-3 py-1 rounded-full text-xs font-medium {% if user.newsletter_subscribed %}bg-green-50 text-green-700{% else %}bg-gray-100 text-gray-600{% endif %}">{% if user.newsletter_subscribed %}Subscribed{% else %}Not Subscribed{% endif %}</span></div>
</div>
</div>

<!-- Quick Links Card -->
<div class="profile-card bg-white rounded-xl shadow-sm p-6">
<h3 class="text-lg font-bold text-gray-900 mb-4 flex items-center"><i class="fas fa-link text-amber-500 mr-3"></i> Quick Links</h3>
<div class="space-y-2">
<a href="{% url 'dashboard:customer_orders' %}" class="flex items-center justify-between p-3 rounded-lg hover:bg-gray-50 transition group"><span class="text-gray-700 group-hover:text-scent-blue text-sm"><i class="fas fa-shopping-bag mr-3 w-5 text-amber-500"></i> My Orders</span><i class="fas fa-chevron-right text-gray-300 group-hover:text-scent-blue text-xs"></i></a>
<a href="{% url 'dashboard:customer_wishlist' %}" class="flex items-center justify-between p-3 rounded-lg hover:bg-gray-50 transition group"><span class="text-gray-700 group-hover:text-scent-blue text-sm"><i class="fas fa-heart mr-3 w-5 text-amber-500"></i> My Wishlist</span><i class="fas fa-chevron-right text-gray-300 group-hover:text-scent-blue text-xs"></i></a>
<a href="{% url 'dashboard:customer_dashboard' %}" class="flex items-center justify-between p-3 rounded-lg hover:bg-gray-50 transition group"><span class="text-gray-700 group-hover:text-scent-blue text-sm"><i class="fas fa-tachometer-alt mr-3 w-5 text-amber-500"></i> Dashboard</span><i class="fas fa-chevron-right text-gray-300 group-hover:text-scent-blue text-xs"></i></a>
<a href="{% url 'store:product_list' %}" class="flex items-center justify-between p-3 rounded-lg hover:bg-gray-50 transition group"><span class="text-gray-700 group-hover:text-scent-blue text-sm"><i class="fas fa-store mr-3 w-5 text-amber-500"></i> Continue Shopping</span><i class="fas fa-chevron-right text-gray-300 group-hover:text-scent-blue text-xs"></i></a>
</div>
</div>

<!-- Security Card -->
<div class="profile-card bg-white rounded-xl shadow-sm p-6">
<h3 class="text-lg font-bold text-gray-900 mb-4 flex items-center"><i class="fas fa-lock text-amber-500 mr-3"></i> Security</h3>
<div class="space-y-3">
<p class="text-sm text-gray-500 mb-4">Keep your account secure by using a strong password.</p>
<a href="#" class="block w-full text-center py-3 px-4 border border-gray-200 rounded-lg text-gray-700 hover:border-scent-blue hover:bg-scent-blue hover:text-white transition text-sm"><i class="fas fa-key mr-2"></i> Change Password</a>
</div>
</div>
</div>

<!-- Right Column - Edit Profile Form -->
<div class="lg:col-span-2">
<div class="profile-card bg-white rounded-xl shadow-sm overflow-hidden">
<!-- Form Header -->
<div class="bg-scent-blue px-4 sm:px-6 py-3 sm:py-4">
<h2 class="text-base sm:text-lg font-bold text-white flex items-center"><i class="fas fa-user-edit mr-2 sm:mr-3 text-amber-500"></i> Edit Profile Information</h2>
<p class="text-gray-400 text-xs sm:text-sm mt-1">Update your personal details and profile picture</p>
</div>

<form method="post" enctype="multipart/form-data" class="p-4 sm:p-6">
{% csrf_token %}
<div class="grid grid-cols-1 md:grid-cols-2 gap-4 sm:gap-6">
<!-- Profile Image Upload -->
<div class="md:col-span-2">
<label class="block text-sm font-semibold text-gray-700 mb-3"><i class="fas fa-camera mr-2 text-amber-500"></i> Profile Photo</label>
<div class="flex items-center space-x-6">
<div class="w-20 h-20 rounded-full bg-gray-900 flex items-center justify-center overflow-hidden border-2 border-amber-500/30">{% if user.profile_image %}<img src="{{ user.profile_image.url }}" alt="Profile" class="w-full h-full object-cover">{% else %}<i class="fas fa-user text-amber-500 text-2xl"></i>{% endif %}</div>
<div class="flex-1">
<input type="file" name="profile_image" id="id_profile_image" accept="image/*" class="block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-lg file:border-0 file:text-sm file:font-semibold file:bg-gray-100 file:text-gray-700 hover:file:bg-gray-200 cursor-pointer">
<p class="text-xs text-gray-400 mt-2">JPG, PNG or GIF. Max size 2MB.</p>
</div>
</div>
</div>

<!-- First Name -->
<div>
<label for="id_first_name" class="block text-sm font-semibold text-gray-700 mb-2"><i class="fas fa-user mr-2 text-amber-500"></i> First Name</label>
<input type="text" name="first_name" id="id_first_name" value="{{ user.first_name }}" class="input-focus w-full px-4 py-3 rounded-lg border border-gray-200 focus:outline-none transition bg-gray-50" placeholder="Enter your first name">
</div>

<!-- Last Name -->
<div>
<label for="id_last_name" class="block text-sm font-semibold text-gray-700 mb-2"><i class="fas fa-user mr-2 text-amber-500"></i> Last Name</label>
<input type="text" name="last_name" id="id_last_name" value="{{ user.last_name }}" class="input-focus w-full px-4 py-3 rounded-lg border border-gray-200 focus:outline-none transition bg-gray-50" placeholder="Enter your last name">
</div>

<!-- Phone -->
<div>
<label for="id_phone" class="block text-sm font-semibold text-gray-700 mb-2"><i class="fas fa-phone mr-2 text-amber-500"></i> Phone Number</label>
<input type="tel" name="phone" id="id_phone" value="{{ user.phone }}" class="input-focus w-full px-4 py-3 rounded-lg border border-gray-200 focus:outline-none transition bg-gray-50" placeholder="+234 xxx xxx xxxx">
</div>

<!-- Date of Birth -->
<div>
<label for="id_date_of_birth" class="block text-sm font-semibold text-gray-700 mb-2"><i class="fas fa-birthday-cake mr-2 text-amber-500"></i> Date of Birth</label>
<input type="date" name="date_of_birth" id="id_date_of_birth" value="{{ user.date_of_birth|date:'Y-m-d' }}" class="input-focus w-full px-4 py-3 rounded-lg border border-gray-200 focus:outline-none transition bg-gray-50">
</div>

<!-- Email (Read Only) -->
<div class="md:col-span-2">
<label class="block text-sm font-semibold text-gray-700 mb-2"><i class="fas fa-envelope mr-2 text-amber-500"></i> Email Address</label>
<div class="flex items-center">
<input type="email" value="{{ user.email|default:'Not provided' }}" disabled class="flex-1 px-4 py-3 rounded-lg border border-gray-100 bg-gray-50 text-gray-400">
<span class="ml-3 text-xs text-gray-400"><i class="fas fa-lock mr-1"></i> Contact support to change</span>
</div>
</div>

<!-- Username (Read Only) -->
<div class="md:col-span-2">
<label class="block text-sm font-semibold text-gray-700 mb-2"><i class="fas fa-at mr-2 text-amber-500"></i> Username</label>
<div class="flex items-center">
<input type="text" value="{{ user.username }}" disabled class="flex-1 px-4 py-3 rounded-lg border border-gray-100 bg-gray-50 text-gray-400">
<span class="ml-3 text-xs text-gray-400"><i class="fas fa-lock mr-1"></i> Cannot be changed</span>
</div>
</div>
</div>

<!-- Form Actions -->
<div class="flex flex-col sm:flex-row justify-between items-center mt-8 pt-6 border-t border-gray-100">
<p class="text-sm text-gray-400 mb-4 sm:mb-0"><i class="fas fa-info-circle mr-1"></i> Last updated: {{ user.date_joined|date:"M d, Y" }}</p>
<div class="flex space-x-4">
<a href="{% url 'dashboard:customer_dashboard' %}" class="px-6 py-3 border border-gray-200 rounded-lg text-gray-600 hover:bg-gray-50 transition font-medium text-sm">Cancel</a>
<button type="submit" class="px-8 py-3 bg-scent-blue text-white rounded-lg hover:bg-gray-800 transition font-semibold text-sm"><i class="fas fa-save mr-2 text-amber-500"></i> Save Changes</button>
</div>
</div>
</form>
</div>
</div>
</div>
</div>
</div>
{% endblock %}
